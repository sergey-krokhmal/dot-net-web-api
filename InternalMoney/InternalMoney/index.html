<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" ng-app="internalMoneyApp">
<head>
    <title>Parrot Wings</title>
</head>
<body>
    <div>
        <h2>Parrot Wings</h2>
    </div>
    <div class="registration-form">
        <fieldset>
            <legend>Регистрация</legend>
            <table>
                <tbody>
                    <tr>
                        <td><input class="input-user-name" type="text" placeholder="Имя" /></td>
                    </tr>
                    <tr>
                        <td><input class="input-user-email" type="email" placeholder="E-mail" /></td>
                    </tr>
                    <tr>
                        <td><input class="input-password" type="password" placeholder="Пароль" /></td>
                    </tr>
                    <tr>
                        <td><input class="input-repeat-password" type="password" placeholder="Повторите пароль" /></td>
                    </tr>
                    <tr>
                        <td><input class="input-submit" type="button" onclick="registerUser()" title="Зарегистрироваться в системе" value="Зарегистрироваться" /></td>
                    </tr>
                </tbody>
            </table>
        </fieldset>
    </div>
    <div class="user-card">
        <div class="user-name"></div>
        <div class="user-balance"></div>
    </div>
    <div class="send-money-form" style="display: none;">
        <select class="user-select"></select>
        <input type="text" class="money" />
    </div>
    <ng-view></ng-view>
    <script src="Scripts/jquery-3.1.1.min.js"></script>
    <!-->script src="Scripts/angular.min.js"></script-->
    <!-->script src="Scripts/app/app.js"></script-->
    <script>
        var uri = 'api/User';

        $(document).ready(function () {
            // Send an AJAX request
            $.getJSON(uri)
                .done(function (data) {
                    // On success, 'data' contains a list of products.
                    console.log(data);
                });
        });

        function ajaxHelper(uri, method, data) {
            return $.ajax({
                type: method,
                url: uri,
                dataType: 'json',
                contentType: 'application/json charset=utf-8',
                data: data ? JSON.stringify(data) : null
            }).fail(function (jqXHR, textStatus, errorThrown) {
            });
        }

        function registerUser() {
            var userName = $('.input-user-name').val();
            var userEmail = $('.input-user-email').val();
            var password = $('.input-password').val();
            var repeatPassword = $('.input-repeat-password').val();
            if (userName != '' && userEmail != '' && password != '' && repeatPassword != '') {
                if (password == repeatPassword) {
                    ajaxHelper(uri, "POST", { Name: userName, Email: userEmail, Password: password, Balance: 500 }).done(function (dd) {
                        if (dd.Id !== undefined) {
                            $('.registration-form').hide();
                            $('.user-card .user-name').text(dd.Name);
                            $('.user-card .user-balance').text(dd.Balance);
                        }
                    });
                }
            }
        }


    </script>
</body>
</html>